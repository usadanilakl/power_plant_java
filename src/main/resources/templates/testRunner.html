<!DOCTYPE html>
<html lang="en" xmlns:th="<http://www.thymeleaf.org>" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta id="token" name="_csrf" th:content="${_csrf.token}"/>
    <meta id="mode" th:content="${mode}"/>
    <title>My Main Layout</title>

    <link rel="stylesheet" href="/bootstrap-5.3.3-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/my_styles/page.css">
    <link rel="stylesheet" href="/my_styles/searchable-dropdown.css">
    <link rel="stylesheet" href="/my_styles/picture.css">
    <link rel="stylesheet" href="/my_styles/menu.css">
    <link rel="stylesheet" href="/my_styles/util.css">
    <link rel="stylesheet" href="/my_styles/floating-menu.css">
    <link rel="stylesheet" href="/my_styles/resize_style.css">
    <link rel="stylesheet" href="/my_styles/infoWindow.css">
    <link rel="stylesheet" href="/my_styles/NewWindowStyle.css">
    <link rel="stylesheet" href="/my_styles/table.css">
    <style>
.areaHighlights{
    border: 2px solid blue !important;
    z-index: 300;
}
[data-loto-point-highlight="true"]{
    border: 2px solid rgb(255, 0, 0) !important;
    z-index: 300;
}
[data-loto-point-highlight="false"]{
    border: 2px solid rgb(13, 255, 0) !important;
    z-index: 300;
}
    </style>
</head>
<body>

    <div id="all">

        <div id="upper">
            <div th:replace="~{partials/index::header}"></div>
        </div>

        <div id="middle">
            <button id="pin-menu">Menu</button>
            <div id="left">
                <div id="menu-layers">
                    <div id="controls">
                        <button onclick="toggleFileButtonContent()">Toggle Name</button>
                        <button onclick="fileFormSetup()">Edit File</button>
                    </div>
                    <div id="items">
                        <!-- <ul>
                            <li th:each="group : ${sortingGroups}">
                                <a class="btn btn-warning dropdownDk" th:text="${group.getValue()}" th:id="${group}" name="subgroups"></a>
                            </li>
                        </ul> -->
                    </div>
                </div>

                <div id="menu-resize"></div>
            </div>
            <div id="right">
                <div id="picture-container" class="view" data-file-id="">
                    <img src="/uploads/jpg/PID/Kiewit/20023894-PD-021A.01.C2CR.01.01.jpg" usemap="#image_map" id="picture">
                    <map name="image_map" id="map"></map>
                </div>
            </div>
        </div>

        <div id="lower" class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <ul >
                        <li class="btn-list-in-line" onclick="removeAllHighlights()">Remove Highlights</li>
                        <li class="btn-list-in-line" onclick="highlightAll()">Highlight All</li>                      
                        <li class="btn-list-in-line" onclick="highlightLotoPoints()">Highlight Loto Points</li>                      
                        <li class="btn-list-in-line" onclick="openNewWindow(getUploadFileForm)">Upload Files</li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div id="formContainer">

                    </div>
                </div>
            </div>
        </div>

        <div id="infoWindowsContainer"></div>

    </div>
    <div id="popup" class="ignoreDk" style="z-index:1060;">
        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Create New Item</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" >
                        <label for="system-name">New Item Name:</label>
                        <input class="form-control group-value" type="text" id="value-name">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <!-- <button type="button" class="btn btn-primary"  id="save">Save changes</button> -->
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="/bootstrap-5.3.3-dist/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- <script src="/functions/dev_functions/Page.js"></script>
    <script src="/functions/dev_functions/Picture.js"></script>
    <script src="/functions/dev_functions/Editing.js"></script>
    <script src="/functions/dev_functions/Http.js"></script>
    <script src="/functions/FileFunctions.js"></script>
    <script src="/functions/display_functions/PopUpForGroups.js"></script>
    <script src="/functions/display_functions/PopUpForHtml.js"></script>
    <script src="/functions/display_functions/DisplayPicture.js"></script>
    <script src="/functions/display_functions/FileDropdown.js"></script>
    <script src="/functions/util_functions/util.js"></script> -->

    <script>
        let token = document.getElementById('token').getAttribute('content');
    </script>
    
    <script src="/functions/globla/PointVariables.js"></script>
    <script src="/functions/util_functions/util.js"></script>
    <script src="/functions/util_functions/SearchableDropdown.js"></script>
    <script src="/functions/util_functions/FormUtil.js"></script>
    <script src="/functions/util_functions/FormBuilder.js"></script>

    <script src="/functions/controllers/PopupController.js"></script>
    <script src="/functions/controllers/ValueController.js"></script>
    <script src="/functions/controllers/FileController.js"></script>
    <script src="/functions/controllers/PointController.js"></script>
    <script src="/functions/controllers/LotoController.js"></script>
    <script src="/functions/controllers/TransferDataController.js"></script>

    <script src="/functions/service/PopupService.js"></script>
    <script src="/functions/service/MenuDropdownService.js"></script>
    <script src="/functions/service/PictureService.js"></script>
    <script src="/functions/service/ResizerService.js"></script>
    <script src="/functions/service/FileService.js"></script>
    <script src="/functions/service/MasterService.js"></script>
    <script src="/functions/service/ModeService.js"></script>
    <script src="/functions/service/TableService.js"></script>
    <script src="/functions/service/InfoWindowService.js"></script>
    <script src="/functions/service/PointService.js"></script>
    <script src="/functions/service/LotoService.js"></script>
    <script src="/functions/service/ValueService.js"></script>
    <script src="/functions/service/NewWindowService.js"></script>
    


    <script>
        let container = document.getElementById('items');
        let picture = document.getElementById('picture');
        let pictureContainer = document.getElementById('picture-container');
        let all = document.getElementById('all');
        let infoWindowsContainer = document.getElementById('infoWindowsContainer');
        let mode = document.getElementById('mode').getAttribute('content');




    getAllFiles()
    .then(()=>getVendors())
    .then(()=>getCategories())
    .then(()=>{
        console.log("Dropdown is ready to be built");
        console.log(fileRepository.length + " files in array")
        createDropdownItem(categories,container);
        let arr = getFilesByVendor("Kiewit");
        //console.log(JSON.stringify(arr[0]))
        document.getElementById('infoFrameOld-LOTO-Points').appendChild(buildPointSearchField());

        let left = document.getElementById('lower').querySelector('ul');
        let item = document.createElement('li');
        item.appendChild(createModeButtons());
        left.appendChild(item);
        item.classList.add('btn-list-in-line');

        

        f = findFileByPartualNumber("20023894-PD-021A");
        loadPictureWithLightFile(f);

        getAllCategoryObjects();
        getAllCategories();
        getAllTransferDataFromDb();
        getRevisedExcelPoints();
        getOldExcelPoints();

        
        

        
    }).then(()=>{
        console.log(JSON.stringify(file))
       if(mode) setMode(mode); 
    })

    pictureContainer.addEventListener('mousedown',(event)=>{
        if(event.button===0){
            event.preventDefault();
            relocateHighlightsWithPicture(event);
        }

    
});
const zoom = zoomPicture.bind(null,picture);
pictureContainer.addEventListener('wheel',zoom);
document.addEventListener('mousedown',handleMouseDown);







    </script>

</body>
</html>